# ✅ MEDICLIP 구글시트 연동 완료 가이드

## 🎯 업데이트된 내용 (2024-10-14)

현재 메디클립 신청폼에 맞춰 구글시트 연동이 완벽하게 설정되었습니다!

### 📋 수집되는 데이터 (총 8개 필드)

| 순서 | 필드명 | 설명 | 예시 |
|------|--------|------|------|
| 1 | 수집된 날짜 | 자동생성 (한국시간) | 2024-10-14 |
| 2 | 시간 | 자동생성 (한국시간) | 15:30:45 |
| 3 | 병원명 | 사용자 입력 | 서울대병원 |
| 4 | 신청자명 | 사용자 입력 | 김원장 |
| 5 | 연락처 | 사용자 입력 | 010-1234-5678 |
| 6 | 출처 | 자동생성 | MEDICLIP 랜딩페이지 |
| 7 | 브라우저 정보 | 자동수집 | Chrome 118.0.0.0 |
| 8 | 유입 경로 | 자동수집 | google.com 또는 direct |

## 🚀 설정 방법 (3단계)

### 1️⃣ Google Apps Script 생성 및 배포
```
1. https://script.google.com 접속
2. "새 프로젝트" 클릭
3. 아래 google-apps-script.js 내용 복사/붙여넣기
4. "실행" → 권한 허용
5. "배포" → "새 배포" → 웹 앱
   - 실행 권한: 나
   - 액세스 권한: 모든 사용자
6. 웹 앱 URL 복사!
```

### 2️⃣ 웹사이트에 URL 적용
```javascript
// js/main.js 454번째 줄에서
const response = await fetch('복사한_웹앱_URL', {
```

### 3️⃣ 테스트 및 확인
```
1. 웹사이트 진단 신청 폼 작성
2. 제출 버튼 클릭  
3. 구글시트에서 데이터 확인
```

## 📊 구글시트 자동 설정 기능

✅ **자동 헤더 생성**: 첫 데이터 입력시 자동으로 헤더 생성  
✅ **브랜드 컬러**: 메디클립 네이비(#0F1541) 헤더 배경  
✅ **자동 열 크기 조정**: 데이터에 맞춰 자동 조정  
✅ **한국 시간**: 서버 시간이 아닌 한국 시간(UTC+9) 적용  

## 🎯 마케팅 분석 가능 데이터

### 📈 시간대별 분석
- 피크 시간대: 언제 가장 많은 신청이 들어오는가?
- 요일별 패턴: 어느 요일에 신청이 집중되는가?

### 🔍 유입 경로 분석  
- 직접 유입 vs 검색 유입
- 주요 유입 사이트 파악
- 마케팅 채널별 효과 측정

### 📱 디바이스 분석
- 모바일 vs 데스크톱 비율
- 브라우저별 사용 현황
- 사용자 환경 최적화 데이터

## 🚨 문제 해결

**Q: 데이터가 들어오지 않아요**
```
A: 다음을 확인하세요:
1. Apps Script URL이 정확히 복사되었는지
2. 배포 설정: "액세스 권한 - 모든 사용자"
3. F12 개발자도구에서 오류 확인
```

**Q: 시간이 이상해요**
```
A: 한국 시간(UTC+9) 자동 적용됩니다.
서버 시간과 다를 수 있지만 정상입니다.
```

**Q: 새로운 필드를 추가하고 싶어요**
```
A: 다음 순서로 진행:
1. HTML 폼에 input 추가
2. js/main.js data 객체에 필드 추가  
3. google-apps-script.js headers/newRow 배열에 추가
4. Apps Script 재배포
```

---

## 🎉 완료 체크리스트

- [ ] Google Apps Script 프로젝트 생성 완료
- [ ] 웹 앱으로 배포 완료  
- [ ] js/main.js에 웹 앱 URL 적용 완료
- [ ] 테스트 제출로 데이터 수집 확인
- [ ] 구글시트에서 실시간 데이터 확인
- [ ] 헤더 스타일링(메디클립 브랜드 컬러) 확인

**🔗 구글시트 링크**: https://docs.google.com/spreadsheets/d/1nYWl0ssXUK36GYhJXmQ2hNsnHD3taPOiLbg0uLwuxRA/edit

**🎯 이제 메디클립의 모든 신청 데이터가 실시간으로 구글시트에 체계적으로 수집됩니다!**